<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>VentaDoc ‚Äî Documenta tu venta de auto en 5 minutos</title>
<meta name="description" content="Contratos digitales para compraventa de autos usados. Fotos, identificaciones y firmas en un solo documento.">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìÑ</text></svg>">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
// Verify jsPDF loaded
window.addEventListener('load', function() {
  if (!window.jspdf) {
    console.error('jsPDF not loaded, trying backup CDN');
    var s = document.createElement('script');
    s.src = 'https://unpkg.com/jspdf@2.5.1/dist/jspdf.umd.min.js';
    document.head.appendChild(s);
  }
});
</script>
<style>
@import url('https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=Fraunces:ital,opsz,wght@0,9..144,600;0,9..144,700;0,9..144,800;1,9..144,400&display=swap');

*{margin:0;padding:0;box-sizing:border-box}

:root{
--bg:#08090A;--surface:#111214;--surface2:#1A1B1E;--border:#252629;
--text:#F0F0EC;--text2:#8E8E8A;--text3:#5A5A57;
--accent:#C8FF3E;--accent2:#B0E636;--accentDim:rgba(200,255,62,0.08);
--error:#FF6B6B;--success:#4ECDC4;--warning:#FFD93D;
--radius:14px;
}

body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100dvh;-webkit-font-smoothing:antialiased;overflow-x:hidden}

/* ANIMATIONS */
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}
@keyframes checkmark{from{stroke-dashoffset:24}to{stroke-dashoffset:0}}
@keyframes spin{to{transform:rotate(360deg)}}

.fade-up{animation:fadeUp 0.5s ease both}
.fade-in{animation:fadeIn 0.4s ease both}

/* HEADER */
.header{
padding:14px 20px;display:flex;align-items:center;justify-content:space-between;
border-bottom:1px solid var(--border);position:sticky;top:0;
background:rgba(8,9,10,0.92);backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);z-index:100;
}
.logo{font-family:'Fraunces',serif;font-weight:800;font-size:21px;letter-spacing:-0.5px}
.logo span{color:var(--accent)}
.step-pills{display:flex;gap:5px;align-items:center}
.pill{width:8px;height:8px;border-radius:50%;background:var(--border);transition:all 0.4s cubic-bezier(.4,0,.2,1)}
.pill.active{background:var(--accent);width:28px;border-radius:4px}
.pill.done{background:var(--success)}
.header-back{background:none;border:none;color:var(--text2);font-size:22px;cursor:pointer;padding:4px 8px;display:none}

/* SCREENS */
.screen{display:none;max-width:520px;margin:0 auto}
.screen.active{display:block}

/* LANDING */
.landing{padding:48px 24px 40px;text-align:center}
.landing-badge{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;background:var(--surface);border:1px solid var(--border);border-radius:100px;font-size:12px;color:var(--text2);margin-bottom:28px;font-weight:500}
.landing-badge .dot{width:6px;height:6px;border-radius:50%;background:var(--accent);animation:pulse 2s infinite}
.landing h1{font-family:'Fraunces',serif;font-size:34px;font-weight:800;line-height:1.12;margin-bottom:14px;letter-spacing:-1.2px}
.landing h1 em{font-style:italic;color:var(--accent)}
.landing>p{color:var(--text2);font-size:15px;line-height:1.6;margin-bottom:36px;max-width:360px;margin-left:auto;margin-right:auto}

.features{display:flex;flex-direction:column;gap:10px;margin-bottom:32px;text-align:left}
.feat{display:flex;gap:14px;align-items:center;padding:14px 16px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)}
.feat-icon{width:40px;height:40px;border-radius:10px;background:var(--accentDim);display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
.feat-txt{font-size:14px;color:var(--text2);line-height:1.45}
.feat-txt strong{color:var(--text);display:block;margin-bottom:1px}

.story-box{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:18px;margin-bottom:28px;text-align:left;position:relative}
.story-box::before{content:'"';position:absolute;top:8px;left:14px;font-family:'Fraunces',serif;font-size:48px;color:var(--accent);opacity:0.2;line-height:1}
.story-box p{font-size:13px;color:var(--text2);line-height:1.6;padding-left:4px}
.story-box strong{color:var(--error)}

.price-pill{display:inline-flex;align-items:baseline;gap:4px;padding:8px 22px;background:var(--accentDim);border:1px solid rgba(200,255,62,0.15);border-radius:100px;margin-bottom:28px;font-size:13px;color:var(--accent)}
.price-pill .big{font-family:'Fraunces',serif;font-size:30px;font-weight:700}

/* FORM ELEMENTS */
.form-section{padding:24px 20px 140px}
.section-title{font-family:'Fraunces',serif;font-size:24px;font-weight:700;margin-bottom:4px;letter-spacing:-0.5px}
.section-sub{color:var(--text2);font-size:14px;margin-bottom:28px;line-height:1.5}
.section-num{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:8px;background:var(--accentDim);color:var(--accent);font-size:13px;font-weight:700;margin-bottom:12px}

.field{margin-bottom:18px}
.field label{display:block;font-size:13px;font-weight:600;color:var(--text2);margin-bottom:6px;letter-spacing:0.2px}
.field input,.field select,.field textarea{
width:100%;padding:14px 16px;background:var(--surface);border:1.5px solid var(--border);
border-radius:12px;color:var(--text);font-family:'DM Sans',sans-serif;font-size:16px;
transition:border-color 0.2s;outline:none;-webkit-appearance:none;
}
.field input:focus,.field select:focus,.field textarea:focus{border-color:var(--accent)}
.field input::placeholder{color:var(--text3)}
.field select{cursor:pointer;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%238E8E8A' viewBox='0 0 16 16'%3E%3Cpath d='M4 6l4 4 4-4'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 14px center}
.field select option{background:var(--surface2);color:var(--text)}

.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}

/* PHOTO UPLOAD */
.photo-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:18px}
.photo-slot{
aspect-ratio:4/3;background:var(--surface);border:2px dashed var(--border);
border-radius:var(--radius);display:flex;flex-direction:column;align-items:center;
justify-content:center;gap:6px;cursor:pointer;transition:all 0.2s;overflow:hidden;position:relative;
}
.photo-slot:hover{border-color:var(--accent);background:var(--accentDim)}
.photo-slot .icon{font-size:28px;opacity:0.6}
.photo-slot .label{font-size:11px;color:var(--text3);font-weight:500;text-align:center;padding:0 8px}
.photo-slot.full{border-style:solid;border-color:var(--success)}
.photo-slot.full img{width:100%;height:100%;object-fit:cover;position:absolute;top:0;left:0}
.photo-slot.full .remove-photo{
position:absolute;top:6px;right:6px;width:26px;height:26px;
background:rgba(0,0,0,0.7);border:none;color:white;border-radius:50%;
font-size:14px;cursor:pointer;display:flex;align-items:center;justify-content:center;
}
.photo-slot input[type="file"]{display:none}

.photo-slot.wide{grid-column:span 2;aspect-ratio:16/9}

/* BOTTOM BAR */
.bottom-bar{
position:fixed;bottom:0;left:0;right:0;padding:16px 20px;
background:rgba(8,9,10,0.95);backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);
border-top:1px solid var(--border);z-index:100;
}
.bottom-bar .inner{max-width:520px;margin:0 auto;display:flex;gap:10px}

.btn{
flex:1;padding:15px 20px;border:none;border-radius:12px;font-family:'DM Sans',sans-serif;
font-size:15px;font-weight:700;cursor:pointer;transition:all 0.2s;letter-spacing:-0.2px;
}
.btn-primary{background:var(--accent);color:#0A0A0A}
.btn-primary:hover{background:var(--accent2)}
.btn-primary:disabled{opacity:0.35;cursor:not-allowed}
.btn-ghost{background:transparent;color:var(--text2);border:1px solid var(--border);flex:0.5}
.btn-ghost:hover{border-color:var(--text2);color:var(--text)}

/* REVIEW */
.review-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:18px;margin-bottom:14px}
.review-card h3{font-size:14px;font-weight:600;color:var(--accent);margin-bottom:12px;display:flex;align-items:center;gap:8px}
.review-row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--border);font-size:14px}
.review-row:last-child{border-bottom:none}
.review-row .rlabel{color:var(--text2)}
.review-row .rvalue{color:var(--text);font-weight:500;text-align:right;max-width:60%}
.review-photos{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
.review-photos img{width:72px;height:54px;object-fit:cover;border-radius:8px;border:1px solid var(--border)}

/* SUCCESS */
.success-screen{padding:60px 24px;text-align:center}
.success-icon{width:80px;height:80px;border-radius:50%;background:rgba(78,205,196,0.12);display:flex;align-items:center;justify-content:center;margin:0 auto 24px;font-size:40px}
.success-screen h2{font-family:'Fraunces',serif;font-size:28px;font-weight:700;margin-bottom:10px}
.success-screen p{color:var(--text2);font-size:15px;line-height:1.6;margin-bottom:32px}

/* LOADING */
.loading-overlay{
position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(8,9,10,0.95);
display:none;align-items:center;justify-content:center;flex-direction:column;gap:20px;z-index:200;
}
.loading-overlay.show{display:flex}
.spinner{width:40px;height:40px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin 0.8s linear infinite}
.loading-text{color:var(--text2);font-size:15px}

/* RESPONSIVE */
@media(min-width:600px){
.landing h1{font-size:42px}
.photo-grid{grid-template-columns:1fr 1fr 1fr}
}
</style>
</head>
<body>

<!-- HEADER -->
<header class="header" id="header">
<button class="header-back" id="backBtn" onclick="goBack()">‚Üê</button>
<div class="logo">Venta<span>Doc</span></div>
<div class="step-pills" id="pills"></div>
</header>

<!-- SCREEN 0: LANDING -->
<div class="screen active" id="screen-0">
<div class="landing fade-up">
<div class="landing-badge"><span class="dot"></span> MVP Beta ‚Äî Tijuana, BC</div>
<h1>Documenta tu venta de auto en <em>5 minutos</em></h1>
<p>Contrato digital con evidencia fotogr√°fica, datos de ambas partes y copia para todos. Sin papeler√≠a, sin copias, sin riesgo.</p>

<div class="features">
<div class="feat">
<div class="feat-icon">ü™™</div>
<div class="feat-txt"><strong>Identificaciones</strong>Foto de la INE de ambas partes. Datos capturados en el contrato.</div>
</div>
<div class="feat">
<div class="feat-icon">üì∏</div>
<div class="feat-txt"><strong>Evidencia del auto</strong>VIN, kilometraje, estado exterior e interior. Todo con fecha y hora.</div>
</div>
<div class="feat">
<div class="feat-icon">üìÑ</div>
<div class="feat-txt"><strong>Contrato PDF</strong>Se genera autom√°ticamente con todos los datos. Copia para ambas partes.</div>
</div>
<div class="feat">
<div class="feat-icon">üõ°Ô∏è</div>
<div class="feat-txt"><strong>Protecci√≥n legal</strong>Evidencia completa en caso de cualquier problema futuro.</div>
</div>
</div>

<div class="story-box">
<p>Cuando vendes un auto, normalmente vas a la papeler√≠a por un contrato gen√©rico, sacas copias de tu INE, llenas todo a mano y tomas fotos con el celular que se pierden en WhatsApp. Con <strong style="color:var(--accent)">VentaDoc</strong>, llenas los datos en tu celular, tomas las fotos y en 5 minutos tienes un contrato PDF profesional con toda la evidencia organizada. Una copia para ti, una para el comprador.</p>
</div>

<div class="price-pill"><span class="big">Gratis</span> durante la beta</div>
<br><br>
<button class="btn btn-primary" onclick="startFlow()" style="max-width:400px">Comenzar contrato ‚Üí</button>
</div>
</div>

<!-- SCREEN 1: VENDEDOR -->
<div class="screen" id="screen-1">
<div class="form-section fade-up">
<div class="section-num">1</div>
<div class="section-title">Datos del vendedor</div>
<p class="section-sub">Quien vende el veh√≠culo. Llena los datos tal como aparecen en tu INE.</p>

<div class="field">
<label>Nombre completo</label>
<input type="text" id="v_nombre" placeholder="Como aparece en tu INE" autocomplete="name">
</div>
<div class="row">
<div class="field">
<label>Tel√©fono</label>
<input type="tel" id="v_telefono" placeholder="10 d√≠gitos" autocomplete="tel">
</div>
<div class="field">
<label>Email (opcional)</label>
<input type="email" id="v_email" placeholder="correo@ejemplo.com" autocomplete="email">
</div>
</div>
<div class="field">
<label>Domicilio</label>
<input type="text" id="v_domicilio" placeholder="Calle, n√∫mero, colonia, ciudad" autocomplete="street-address">
</div>
<div class="field">
<label>Clave de elector (INE)</label>
<input type="text" id="v_ine" placeholder="18 caracteres alfanum√©ricos" maxlength="18" style="text-transform:uppercase">
</div>

<div class="field">
<label>Foto de tu INE (frente)</label>
<div class="photo-grid">
<div class="photo-slot wide" id="slot-v-ine-frente" onclick="triggerPhoto(this,'v_ine_frente')">
<input type="file" accept="image/*" capture="environment" onchange="handlePhoto(event,'slot-v-ine-frente','v_ine_frente')">
<span class="icon">ü™™</span>
<span class="label">Toca para tomar foto del frente de tu INE</span>
</div>
</div>
</div>
</div>
</div>

<!-- SCREEN 2: COMPRADOR -->
<div class="screen" id="screen-2">
<div class="form-section fade-up">
<div class="section-num">2</div>
<div class="section-title">Datos del comprador</div>
<p class="section-sub">Quien compra el veh√≠culo. P√≠dele su INE y llena sus datos.</p>

<div class="field">
<label>Nombre completo</label>
<input type="text" id="c_nombre" placeholder="Como aparece en su INE">
</div>
<div class="row">
<div class="field">
<label>Tel√©fono</label>
<input type="tel" id="c_telefono" placeholder="10 d√≠gitos">
</div>
<div class="field">
<label>Email (opcional)</label>
<input type="email" id="c_email" placeholder="correo@ejemplo.com">
</div>
</div>
<div class="field">
<label>Domicilio</label>
<input type="text" id="c_domicilio" placeholder="Calle, n√∫mero, colonia, ciudad">
</div>
<div class="field">
<label>Clave de elector (INE)</label>
<input type="text" id="c_ine" placeholder="18 caracteres alfanum√©ricos" maxlength="18" style="text-transform:uppercase">
</div>

<div class="field">
<label>Foto de su INE (frente)</label>
<div class="photo-grid">
<div class="photo-slot wide" id="slot-c-ine-frente" onclick="triggerPhoto(this,'c_ine_frente')">
<input type="file" accept="image/*" capture="environment" onchange="handlePhoto(event,'slot-c-ine-frente','c_ine_frente')">
<span class="icon">ü™™</span>
<span class="label">Toca para tomar foto del frente de su INE</span>
</div>
</div>
</div>
</div>
</div>

<!-- SCREEN 3: AUTO -->
<div class="screen" id="screen-3">
<div class="form-section fade-up">
<div class="section-num">3</div>
<div class="section-title">Datos del veh√≠culo</div>
<p class="section-sub">Informaci√≥n del auto que se vende. Revisa la tarjeta de circulaci√≥n.</p>

<div class="row">
<div class="field">
<label>Marca</label>
<input type="text" id="a_marca" placeholder="Ej: Honda, Toyota">
</div>
<div class="field">
<label>Modelo</label>
<input type="text" id="a_modelo" placeholder="Ej: Civic, Corolla">
</div>
</div>
<div class="row">
<div class="field">
<label>A√±o</label>
<input type="number" id="a_a√±o" placeholder="Ej: 2018" min="1970" max="2027">
</div>
<div class="field">
<label>Color</label>
<input type="text" id="a_color" placeholder="Ej: Blanco">
</div>
</div>
<div class="field">
<label>N√∫mero de serie (VIN)</label>
<input type="text" id="a_vin" placeholder="17 caracteres" maxlength="17" style="text-transform:uppercase">
</div>
<div class="field">
<label>Placas</label>
<input type="text" id="a_placas" placeholder="Ej: ABC-123" style="text-transform:uppercase">
</div>
<div class="row">
<div class="field">
<label>Kilometraje</label>
<input type="number" id="a_km" placeholder="Ej: 85000">
</div>
<div class="field">
<label>Precio de venta (MXN)</label>
<input type="number" id="a_precio" placeholder="Ej: 120000">
</div>
</div>
</div>
</div>

<!-- SCREEN 4: FOTOS DEL AUTO -->
<div class="screen" id="screen-4">
<div class="form-section fade-up">
<div class="section-num">4</div>
<div class="section-title">Fotos del veh√≠culo</div>
<p class="section-sub">Toma fotos del estado actual del auto. Estas quedar√°n en el contrato como evidencia.</p>

<div class="field">
<label>Fotos obligatorias</label>
<div class="photo-grid">
<div class="photo-slot" id="slot-foto-vin" onclick="triggerPhoto(this,'foto_vin')">
<input type="file" accept="image/*" capture="environment" onchange="handlePhoto(event,'slot-foto-vin','foto_vin')">
<span class="icon">üî¢</span>
<span class="label">VIN / N√∫mero de serie</span>
</div>
<div class="photo-slot" id="slot-foto-km" onclick="triggerPhoto(this,'foto_km')">
<input type="file" accept="image/*" capture="environment" onchange="handlePhoto(event,'slot-foto-km','foto_km')">
<span class="icon">üîÑ</span>
<span class="label">Kilometraje</span>
</div>
<div class="photo-slot" id="slot-foto-frente" onclick="triggerPhoto(this,'foto_frente')">
<input type="file" accept="image/*" capture="environment" onchange="handlePhoto(event,'slot-foto-frente','foto_frente')">
<span class="icon">üöó</span>
<span class="label">Frente del auto</span>
</div>
<div class="photo-slot" id="slot-foto-trasera" onclick="triggerPhoto(this,'foto_trasera')">
<input type="file" accept="image/*" capture="environment" onchange="handlePhoto(event,'slot-foto-trasera','foto_trasera')">
<span class="icon">üöô</span>
<span class="label">Parte trasera</span>
</div>
</div>
</div>

<div class="field">
<label>Fotos opcionales (da√±os, detalles)</label>
<div class="photo-grid">
<div class="photo-slot" id="slot-foto-extra1" onclick="triggerPhoto(this,'foto_extra1')">
<input type="file" accept="image/*" capture="environment" onchange="handlePhoto(event,'slot-foto-extra1','foto_extra1')">
<span class="icon">‚ûï</span>
<span class="label">Foto adicional</span>
</div>
<div class="photo-slot" id="slot-foto-extra2" onclick="triggerPhoto(this,'foto_extra2')">
<input type="file" accept="image/*" capture="environment" onchange="handlePhoto(event,'slot-foto-extra2','foto_extra2')">
<span class="icon">‚ûï</span>
<span class="label">Foto adicional</span>
</div>
</div>
</div>

<div class="field">
<label>Observaciones (opcional)</label>
<textarea id="a_observaciones" rows="3" placeholder="Detalles adicionales: golpes, fallas mec√°nicas, acuerdos especiales..." style="width:100%;padding:14px 16px;background:var(--surface);border:1.5px solid var(--border);border-radius:12px;color:var(--text);font-family:'DM Sans',sans-serif;font-size:16px;resize:vertical;outline:none"></textarea>
</div>
</div>
</div>

<!-- SCREEN 5: REVIEW -->
<div class="screen" id="screen-5">
<div class="form-section fade-up">
<div class="section-num">‚úì</div>
<div class="section-title">Revisa el contrato</div>
<p class="section-sub">Verifica que todos los datos sean correctos antes de generar el PDF.</p>

<div class="review-card" id="review-vendedor">
<h3>üü¢ Vendedor</h3>
</div>
<div class="review-card" id="review-comprador">
<h3>üîµ Comprador</h3>
</div>
<div class="review-card" id="review-auto">
<h3>üöó Veh√≠culo</h3>
</div>
<div class="review-card" id="review-fotos">
<h3>üì∏ Evidencia fotogr√°fica</h3>
<div class="review-photos" id="review-photos-grid"></div>
</div>
</div>
</div>

<!-- SCREEN 6: SUCCESS -->
<div class="screen" id="screen-6">
<div class="success-screen fade-up">
<div class="success-icon">‚úÖ</div>
<h2>¬°Contrato generado!</h2>
<p>Tu contrato de compraventa se descarg√≥ como PDF. Comparte una copia con el comprador por WhatsApp o email.</p>
<button class="btn btn-primary" onclick="downloadPDF()" style="margin-bottom:14px">üìÑ Descargar PDF otra vez</button>
<button class="btn btn-ghost" onclick="shareWhatsApp()" style="flex:1;width:100%">üì§ Compartir contrato</button>
<br><br>
<button class="btn btn-ghost" onclick="resetAll()" style="flex:1;width:100%;margin-top:8px">Crear otro contrato</button>
</div>
</div>

<!-- BOTTOM BAR -->
<div class="bottom-bar" id="bottomBar" style="display:none">
<div class="inner">
<button class="btn btn-ghost" id="btnBack" onclick="goBack()">Atr√°s</button>
<button class="btn btn-primary" id="btnNext" onclick="goNext()">Siguiente ‚Üí</button>
</div>
</div>

<!-- LOADING -->
<div class="loading-overlay" id="loading">
<div class="spinner"></div>
<div class="loading-text">Generando contrato PDF...</div>
</div>

<script>
// ===== STATE =====
let currentScreen = 0;
const totalSteps = 5;
const photos = {};

// ===== NAVIGATION =====
function showScreen(n) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  const screen = document.getElementById(`screen-${n}`);
  screen.classList.add('active');
  screen.querySelector('.fade-up,.form-section')?.classList.remove('fade-up');
  void screen.offsetWidth;
  screen.querySelector('.form-section')?.classList.add('fade-up');
  
  currentScreen = n;
  updateUI();
  window.scrollTo(0, 0);
}

function updateUI() {
  const bar = document.getElementById('bottomBar');
  const back = document.getElementById('backBtn');
  const btnBack = document.getElementById('btnBack');
  
  if (currentScreen === 0 || currentScreen === 6) {
    bar.style.display = 'none';
    back.style.display = 'none';
  } else {
    bar.style.display = 'block';
    back.style.display = 'block';
    btnBack.style.display = currentScreen === 1 ? 'none' : '';
  }
  
  // Update pills
  const pills = document.getElementById('pills');
  pills.innerHTML = '';
  if (currentScreen >= 1 && currentScreen <= 5) {
    for (let i = 1; i <= totalSteps; i++) {
      const p = document.createElement('div');
      p.className = 'pill';
      if (i === currentScreen) p.classList.add('active');
      else if (i < currentScreen) p.classList.add('done');
      pills.appendChild(p);
    }
  }
  
  // Update next button
  const btnNext = document.getElementById('btnNext');
  if (currentScreen === 5) {
    btnNext.textContent = 'üìÑ Generar contrato';
  } else {
    btnNext.textContent = 'Siguiente ‚Üí';
  }
}

function startFlow() { showScreen(1); }

function goBack() {
  if (currentScreen > 1) showScreen(currentScreen - 1);
  else if (currentScreen === 1) showScreen(0);
}

function goNext() {
  if (currentScreen === 5) {
    generatePDF();
    return;
  }
  if (validateScreen(currentScreen)) {
    if (currentScreen === 4) {
      buildReview();
    }
    showScreen(currentScreen + 1);
  }
}

// ===== VALIDATION =====
function validateScreen(n) {
  let required = [];
  switch(n) {
    case 1: required = ['v_nombre','v_telefono','v_domicilio','v_ine']; break;
    case 2: required = ['c_nombre','c_telefono','c_domicilio','c_ine']; break;
    case 3: required = ['a_marca','a_modelo','a_a√±o','a_color','a_vin','a_placas','a_precio']; break;
    case 4: return true;
  }
  
  let valid = true;
  required.forEach(id => {
    const el = document.getElementById(id);
    if (!el.value.trim()) {
      el.style.borderColor = 'var(--error)';
      valid = false;
      if (!document.querySelector('.shake')) el.classList.add('shake');
      setTimeout(() => { el.style.borderColor = ''; }, 2000);
    }
  });
  
  if (!valid) {
    const first = required.find(id => !document.getElementById(id).value.trim());
    document.getElementById(first)?.focus();
    document.getElementById(first)?.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }
  return valid;
}

// ===== PHOTOS =====
function triggerPhoto(slot, key) {
  if (slot.classList.contains('full')) return;
  slot.querySelector('input[type="file"]').click();
}

function handlePhoto(event, slotId, key) {
  const file = event.target.files[0];
  if (!file) return;
  
  // Compress image before storing
  const reader = new FileReader();
  reader.onload = function(e) {
    const img = new Image();
    img.onload = function() {
      const canvas = document.createElement('canvas');
      const maxSize = 1200;
      let w = img.width, h = img.height;
      if (w > maxSize || h > maxSize) {
        if (w > h) { h = Math.round(h * maxSize / w); w = maxSize; }
        else { w = Math.round(w * maxSize / h); h = maxSize; }
      }
      canvas.width = w;
      canvas.height = h;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0, w, h);
      const compressed = canvas.toDataURL('image/jpeg', 0.7);
      
      photos[key] = compressed;
      const slot = document.getElementById(slotId);
      slot.classList.add('full');
      slot.innerHTML = `
        <img src="${compressed}" alt="${key}">
        <button class="remove-photo" onclick="removePhoto(event,'${slotId}','${key}')">‚úï</button>
        <input type="file" accept="image/*" capture="environment" onchange="handlePhoto(event,'${slotId}','${key}')">
      `;
    };
    img.src = e.target.result;
  };
  reader.readAsDataURL(file);
}

function removePhoto(event, slotId, key) {
  event.stopPropagation();
  delete photos[key];
  const slot = document.getElementById(slotId);
  slot.classList.remove('full');
  
  const labels = {
    v_ine_frente: 'ü™™|Toca para tomar foto del frente de tu INE',
    c_ine_frente: 'ü™™|Toca para tomar foto del frente de su INE',
    foto_vin: 'üî¢|VIN / N√∫mero de serie',
    foto_km: 'üîÑ|Kilometraje',
    foto_frente: 'üöó|Frente del auto',
    foto_trasera: 'üöô|Parte trasera',
    foto_extra1: '‚ûï|Foto adicional',
    foto_extra2: '‚ûï|Foto adicional',
  };
  const [icon, label] = (labels[key] || 'üì∑|Foto').split('|');
  slot.innerHTML = `
    <input type="file" accept="image/*" capture="environment" onchange="handlePhoto(event,'${slotId}','${key}')">
    <span class="icon">${icon}</span>
    <span class="label">${label}</span>
  `;
}

// ===== REVIEW =====
function buildReview() {
  const v = (id) => document.getElementById(id).value || '‚Äî';
  const fmt = (n) => {
    const num = parseInt(n);
    return isNaN(num) ? '‚Äî' : '$' + num.toLocaleString('es-MX');
  };
  
  document.getElementById('review-vendedor').innerHTML = `
    <h3>üü¢ Vendedor</h3>
    <div class="review-row"><span class="rlabel">Nombre</span><span class="rvalue">${v('v_nombre')}</span></div>
    <div class="review-row"><span class="rlabel">Tel√©fono</span><span class="rvalue">${v('v_telefono')}</span></div>
    <div class="review-row"><span class="rlabel">Email</span><span class="rvalue">${v('v_email') || '‚Äî'}</span></div>
    <div class="review-row"><span class="rlabel">Domicilio</span><span class="rvalue">${v('v_domicilio')}</span></div>
    <div class="review-row"><span class="rlabel">Clave INE</span><span class="rvalue">${v('v_ine')}</span></div>
  `;
  
  document.getElementById('review-comprador').innerHTML = `
    <h3>üîµ Comprador</h3>
    <div class="review-row"><span class="rlabel">Nombre</span><span class="rvalue">${v('c_nombre')}</span></div>
    <div class="review-row"><span class="rlabel">Tel√©fono</span><span class="rvalue">${v('c_telefono')}</span></div>
    <div class="review-row"><span class="rlabel">Email</span><span class="rvalue">${v('c_email') || '‚Äî'}</span></div>
    <div class="review-row"><span class="rlabel">Domicilio</span><span class="rvalue">${v('c_domicilio')}</span></div>
    <div class="review-row"><span class="rlabel">Clave INE</span><span class="rvalue">${v('c_ine')}</span></div>
  `;
  
  document.getElementById('review-auto').innerHTML = `
    <h3>üöó Veh√≠culo</h3>
    <div class="review-row"><span class="rlabel">Marca / Modelo</span><span class="rvalue">${v('a_marca')} ${v('a_modelo')}</span></div>
    <div class="review-row"><span class="rlabel">A√±o</span><span class="rvalue">${v('a_a√±o')}</span></div>
    <div class="review-row"><span class="rlabel">Color</span><span class="rvalue">${v('a_color')}</span></div>
    <div class="review-row"><span class="rlabel">VIN</span><span class="rvalue" style="font-size:12px">${v('a_vin')}</span></div>
    <div class="review-row"><span class="rlabel">Placas</span><span class="rvalue">${v('a_placas')}</span></div>
    <div class="review-row"><span class="rlabel">Kilometraje</span><span class="rvalue">${v('a_km') ? parseInt(v('a_km')).toLocaleString('es-MX') + ' km' : '‚Äî'}</span></div>
    <div class="review-row"><span class="rlabel">Precio</span><span class="rvalue" style="color:var(--accent);font-weight:700">${fmt(v('a_precio'))}</span></div>
  `;
  
  const grid = document.getElementById('review-photos-grid');
  grid.innerHTML = '';
  const photoLabels = {
    v_ine_frente:'INE Vendedor', c_ine_frente:'INE Comprador',
    foto_vin:'VIN', foto_km:'Kilometraje', foto_frente:'Frente', foto_trasera:'Trasera',
    foto_extra1:'Extra 1', foto_extra2:'Extra 2'
  };
  Object.keys(photos).forEach(key => {
    grid.innerHTML += `<img src="${photos[key]}" title="${photoLabels[key]||key}">`;
  });
  if (Object.keys(photos).length === 0) {
    grid.innerHTML = '<p style="color:var(--text3);font-size:13px">No se tomaron fotos</p>';
  }
}

// ===== PDF GENERATION =====
let pdfBlob = null;
let pdfDataUri = null;

async function generatePDF() {
  const loading = document.getElementById('loading');
  loading.classList.add('show');
  
  await new Promise(r => setTimeout(r, 300));
  
  // Check jsPDF is available
  if (!window.jspdf || !window.jspdf.jsPDF) {
    loading.classList.remove('show');
    alert('Error: La librer√≠a de PDF no se carg√≥. Verifica tu conexi√≥n a internet y recarga la p√°gina.');
    return;
  }
  
  try {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF('p', 'mm', 'letter');
    const w = doc.internal.pageSize.getWidth();
    const margin = 20;
    const contentW = w - margin * 2;
    let y = 20;
    
    const v = (id) => { try { return document.getElementById(id)?.value || ''; } catch(e) { return ''; } };
    const now = new Date();
    const dateStr = now.toLocaleDateString('es-MX', { year:'numeric', month:'long', day:'numeric', hour:'2-digit', minute:'2-digit' });
    const fmt = (n) => {
      const num = parseInt(n);
      return isNaN(num) ? '' : '$' + num.toLocaleString('es-MX') + ' MXN';
    };
    
    // Helper to add text with word wrap
    function addText(text, x, yPos, opts = {}) {
      const size = opts.size || 10;
      const maxW = opts.maxW || contentW;
      doc.setFontSize(size);
      doc.setFont('helvetica', opts.style || 'normal');
      if (opts.color) doc.setTextColor(...opts.color);
      else doc.setTextColor(30, 30, 30);
      
      const lines = doc.splitTextToSize(text, maxW);
      lines.forEach(line => {
        if (yPos > 250) {
          doc.addPage();
          yPos = 20;
        }
        doc.text(line, x, yPos);
        yPos += size * 0.45;
      });
      return yPos;
    }
    
    function addLine(yPos) {
      doc.setDrawColor(200, 200, 200);
      doc.line(margin, yPos, w - margin, yPos);
      return yPos + 6;
    }
    
    function checkPage(yPos, needed = 30) {
      if (yPos + needed > 250) {
        doc.addPage();
        return 20;
      }
      return yPos;
    }
    
    // ===== HEADER =====
    doc.setFontSize(22);
    doc.setFont('helvetica', 'bold');
    doc.setTextColor(30, 30, 30);
    doc.text('CONTRATO DE COMPRAVENTA', margin, y);
    y += 7;
    doc.setFontSize(12);
    doc.setFont('helvetica', 'normal');
    doc.setTextColor(100, 100, 100);
    doc.text('DE VEH√çCULO USADO ENTRE PARTICULARES', margin, y);
    y += 5;
    
    doc.setFontSize(9);
    doc.text(`Generado por VentaDoc ‚Äî ${dateStr}`, margin, y);
    y += 4;
    doc.setFontSize(8);
    doc.setTextColor(150, 150, 150);
    doc.text(`ID: VD-${Date.now().toString(36).toUpperCase()}`, margin, y);
    y += 6;
    y = addLine(y);
    
    // ===== CONTRACT TEXT =====
    const ciudad = 'Tijuana, Baja California';
    const contractText = `En la ciudad de ${ciudad}, a ${now.toLocaleDateString('es-MX', {day:'numeric',month:'long',year:'numeric'})}, comparecen por una parte como VENDEDOR(A): ${v('v_nombre')}, con domicilio en ${v('v_domicilio')}, con clave de elector ${v('v_ine').toUpperCase()}, tel√©fono ${v('v_telefono')}; y por otra parte como COMPRADOR(A): ${v('c_nombre')}, con domicilio en ${v('c_domicilio')}, con clave de elector ${v('c_ine').toUpperCase()}, tel√©fono ${v('c_telefono')}; quienes por su propio derecho celebran el presente contrato de compraventa de veh√≠culo usado, al tenor de las siguientes:`;
    
    y = addText(contractText, margin, y, { size: 10 });
    y += 4;
    
    // CLAUSES
    y = addText('CL√ÅUSULAS', margin, y, { size: 12, style: 'bold' });
    y += 2;
    
    const vehicleDesc = `${v('a_marca')} ${v('a_modelo')} ${v('a_a√±o')}, color ${v('a_color')}, con n√∫mero de serie (VIN): ${v('a_vin').toUpperCase()}, placas: ${v('a_placas').toUpperCase()}, con kilometraje de ${v('a_km') ? parseInt(v('a_km')).toLocaleString('es-MX') : 'N/A'} km al momento de la venta.`;
    
    const clauses = [
      `PRIMERA.- OBJETO. El VENDEDOR transfiere la propiedad del siguiente veh√≠culo al COMPRADOR: ${vehicleDesc}`,
      `SEGUNDA.- PRECIO. El precio pactado por ambas partes para la compraventa del veh√≠culo descrito es de ${fmt(v('a_precio'))} (${numberToWords(parseInt(v('a_precio')))} pesos mexicanos), que el COMPRADOR paga al VENDEDOR en este acto.`,
      `TERCERA.- CONDICIONES. El COMPRADOR declara que ha revisado el veh√≠culo y lo acepta en el estado f√≠sico y mec√°nico en que se encuentra al momento de esta operaci√≥n. ${v('a_observaciones') ? 'Observaciones: ' + v('a_observaciones') : ''}`,
      `CUARTA.- RESPONSABILIDAD. A partir de la firma del presente contrato, el COMPRADOR asume toda responsabilidad civil, penal y administrativa sobre el veh√≠culo. El VENDEDOR queda libre de cualquier responsabilidad sobre el uso del veh√≠culo posterior a esta fecha.`,
      `QUINTA.- DOCUMENTACI√ìN. El VENDEDOR entrega al COMPRADOR la documentaci√≥n del veh√≠culo y se compromete a realizar los tr√°mites de baja correspondientes ante las autoridades de tr√°nsito.`,
      `SEXTA.- EVIDENCIA. Las partes aceptan que las fotograf√≠as anexas a este documento (identificaciones, VIN, estado del veh√≠culo) forman parte integral de este contrato como evidencia del estado del veh√≠culo y la identidad de las partes al momento de la transacci√≥n.`,
      `S√âPTIMA.- JURISDICCI√ìN. Para todo lo relacionado con la interpretaci√≥n y cumplimiento de este contrato, las partes se someten a la jurisdicci√≥n de los tribunales competentes de ${ciudad}.`,
    ];
    
    clauses.forEach(clause => {
      y = checkPage(y, 20);
      y = addText(clause, margin, y, { size: 9.5 });
      y += 4;
    });
    
    // SIGNATURES
    y = checkPage(y, 50);
    y += 8;
    y = addLine(y);
    y += 4;
    y = addText('FIRMAS', margin, y, { size: 12, style: 'bold' });
    y += 12;
    
    // Signature lines
    const sigW = contentW / 2 - 10;
    doc.setDrawColor(30, 30, 30);
    doc.line(margin, y, margin + sigW, y);
    doc.line(margin + sigW + 20, y, margin + sigW + 20 + sigW, y);
    y += 5;
    doc.setFontSize(9);
    doc.setFont('helvetica', 'bold');
    doc.text('VENDEDOR', margin, y);
    doc.text('COMPRADOR', margin + sigW + 20, y);
    y += 4;
    doc.setFont('helvetica', 'normal');
    doc.setFontSize(8);
    doc.text(v('v_nombre'), margin, y);
    doc.text(v('c_nombre'), margin + sigW + 20, y);
    
    // ===== PHOTO PAGES =====
    const photoEntries = Object.entries(photos);
    if (photoEntries.length > 0) {
      doc.addPage();
      y = 20;
      doc.setFontSize(16);
      doc.setFont('helvetica', 'bold');
      doc.setTextColor(30, 30, 30);
      doc.text('ANEXO FOTOGR√ÅFICO', margin, y);
      y += 5;
      doc.setFontSize(9);
      doc.setFont('helvetica', 'normal');
      doc.setTextColor(100, 100, 100);
      doc.text(`Evidencia capturada el ${dateStr}`, margin, y);
      y += 8;
      
      const photoLabels = {
        v_ine_frente: 'INE del Vendedor (frente)',
        c_ine_frente: 'INE del Comprador (frente)',
        foto_vin: 'N√∫mero de serie (VIN)',
        foto_km: 'Kilometraje',
        foto_frente: 'Vista frontal del veh√≠culo',
        foto_trasera: 'Vista trasera del veh√≠culo',
        foto_extra1: 'Foto adicional 1',
        foto_extra2: 'Foto adicional 2',
      };
      
      for (const [key, dataUrl] of photoEntries) {
        y = checkPage(y, 80);
        
        doc.setFontSize(9);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(60, 60, 60);
        doc.text(photoLabels[key] || key, margin, y);
        y += 4;
        
        try {
          const imgW = 80;
          const imgH = 60;
          doc.addImage(dataUrl, 'JPEG', margin, y, imgW, imgH);
          
          doc.setFontSize(7);
          doc.setFont('helvetica', 'normal');
          doc.setTextColor(150, 150, 150);
          doc.text(dateStr, margin + imgW + 4, y + 6);
          
          y += imgH + 8;
        } catch (imgErr) {
          console.warn('Error adding image ' + key, imgErr);
          doc.setFontSize(8);
          doc.setTextColor(200, 100, 100);
          doc.text('[Imagen no disponible: ' + (photoLabels[key]||key) + ']', margin, y);
          y += 8;
        }
      }
    }
    
    // ===== FOOTER on all pages =====
    const totalPages = doc.internal.getNumberOfPages();
    for (let i = 1; i <= totalPages; i++) {
      doc.setPage(i);
      doc.setFontSize(7);
      doc.setFont('helvetica', 'normal');
      doc.setTextColor(170, 170, 170);
      doc.text(`VentaDoc ‚Äî Contrato digital de compraventa ‚Ä¢ P√°gina ${i} de ${totalPages}`, margin, 270);
      doc.text(`Este documento fue generado digitalmente y contiene evidencia fotogr√°fica con marca de tiempo.`, margin, 274);
    }
    
    // Save
    const fileName = `VentaDoc_${v('a_marca')}_${v('a_modelo')}_${v('a_a√±o')}_${now.toISOString().slice(0,10)}.pdf`;
    
    // Store for re-download
    pdfBlob = doc.output('blob');
    pdfDataUri = doc.output('datauristring');
    
    // On mobile, open PDF in new tab (most reliable method)
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    
    if (isMobile) {
      // Mobile: open as data URI in same window or new tab
      const pdfWindow = window.open('', '_blank');
      if (pdfWindow) {
        pdfWindow.document.write(
          '<html><head><title>VentaDoc - Contrato</title><meta name="viewport" content="width=device-width,initial-scale=1"></head>' +
          '<body style="margin:0;padding:0;background:#000">' +
          '<embed src="' + pdfDataUri + '" type="application/pdf" width="100%" height="100%" style="position:fixed;top:0;left:0;width:100%;height:100%">' +
          '<p style="text-align:center;padding:20px;color:white;font-family:sans-serif">' +
          'Si no ves el PDF, <a href="' + pdfDataUri + '" download="' + fileName + '" style="color:#C8FF3E">toca aqu√≠ para descargarlo</a></p>' +
          '</body></html>'
        );
        pdfWindow.document.close();
      } else {
        // Popup blocked: fallback to direct download link
        try { doc.save(fileName); } catch(e) {
          const a = document.createElement('a');
          a.href = pdfDataUri;
          a.download = fileName;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
        }
      }
    } else {
      // Desktop: direct save
      doc.save(fileName);
    }
    
    loading.classList.remove('show');
    showScreen(6);
    
  } catch (err) {
    loading.classList.remove('show');
    console.error('PDF generation error:', err);
    alert('Error al generar PDF: ' + err.message + '\n\nIntenta de nuevo. Si el problema persiste, intenta sin fotos.');
  }
}

function downloadPDF() {
  if (pdfDataUri) {
    const v = (id) => document.getElementById(id)?.value || '';
    const fileName = `VentaDoc_${v('a_marca')}_${v('a_modelo')}_${v('a_a√±o')}_${new Date().toISOString().slice(0,10)}.pdf`;
    
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    if (isMobile) {
      const pdfWindow = window.open('', '_blank');
      if (pdfWindow) {
        pdfWindow.document.write(
          '<html><head><title>VentaDoc - Contrato</title><meta name="viewport" content="width=device-width,initial-scale=1"></head>' +
          '<body style="margin:0;padding:0;background:#000">' +
          '<embed src="' + pdfDataUri + '" type="application/pdf" width="100%" height="100%" style="position:fixed;top:0;left:0;width:100%;height:100%">' +
          '<p style="text-align:center;padding:20px;color:white;font-family:sans-serif">' +
          'Si no ves el PDF, <a href="' + pdfDataUri + '" download="' + fileName + '" style="color:#C8FF3E">toca aqu√≠ para descargarlo</a></p>' +
          '</body></html>'
        );
        pdfWindow.document.close();
      } else {
        const a = document.createElement('a');
        a.href = pdfDataUri;
        a.download = fileName;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      }
    } else {
      const a = document.createElement('a');
      a.href = URL.createObjectURL(pdfBlob);
      a.download = fileName;
      a.click();
    }
  }
}

function shareWhatsApp() {
  const v = (id) => document.getElementById(id)?.value || '';
  const fileName = `VentaDoc_${v('a_marca')}_${v('a_modelo')}_${v('a_a√±o')}_${new Date().toISOString().slice(0,10)}.pdf`;
  
  // Try Web Share API (works on modern mobile browsers - can share actual files)
  if (navigator.share && navigator.canShare && pdfBlob) {
    const file = new File([pdfBlob], fileName, { type: 'application/pdf' });
    
    if (navigator.canShare({ files: [file] })) {
      navigator.share({
        title: 'Contrato de compraventa',
        text: `Contrato de compraventa del ${v('a_marca')} ${v('a_modelo')} ${v('a_a√±o')} generado con VentaDoc.`,
        files: [file]
      }).catch(err => {
        console.log('Share cancelled or failed:', err);
      });
      return;
    }
  }
  
  // Fallback: save PDF first, then open WhatsApp with message
  alert('Para compartir por WhatsApp:\n\n1. Primero descarga el PDF tocando "Descargar PDF"\n2. Abre WhatsApp\n3. Adjunta el PDF desde tus archivos descargados');
}

function resetAll() {
  document.querySelectorAll('input, textarea, select').forEach(el => el.value = '');
  document.querySelectorAll('.photo-slot.full').forEach(slot => {
    const key = slot.id.replace('slot-','').replace(/-/g,'_');
    removePhoto(new Event('click'), slot.id, key);
  });
  Object.keys(photos).forEach(k => delete photos[k]);
  pdfBlob = null;
  pdfDataUri = null;
  showScreen(0);
}

// ===== NUMBER TO WORDS =====
function numberToWords(n) {
  if (isNaN(n) || n === 0) return 'cero';
  
  const units = ['','un','dos','tres','cuatro','cinco','seis','siete','ocho','nueve'];
  const teens = ['diez','once','doce','trece','catorce','quince','diecis√©is','diecisiete','dieciocho','diecinueve'];
  const tens = ['','','veinte','treinta','cuarenta','cincuenta','sesenta','setenta','ochenta','noventa'];
  const hundreds = ['','ciento','doscientos','trescientos','cuatrocientos','quinientos','seiscientos','setecientos','ochocientos','novecientos'];
  
  if (n === 100) return 'cien';
  
  function convert(num) {
    if (num === 0) return '';
    if (num < 10) return units[num];
    if (num < 20) return teens[num - 10];
    if (num < 30) return num === 20 ? 'veinte' : 'veinti' + units[num - 20];
    if (num < 100) {
      const t = Math.floor(num / 10);
      const u = num % 10;
      return tens[t] + (u ? ' y ' + units[u] : '');
    }
    if (num === 100) return 'cien';
    if (num < 1000) {
      const h = Math.floor(num / 100);
      const rest = num % 100;
      return hundreds[h] + (rest ? ' ' + convert(rest) : '');
    }
    if (num < 1000000) {
      const th = Math.floor(num / 1000);
      const rest = num % 1000;
      const thWord = th === 1 ? 'mil' : convert(th) + ' mil';
      return thWord + (rest ? ' ' + convert(rest) : '');
    }
    if (num < 1000000000) {
      const mil = Math.floor(num / 1000000);
      const rest = num % 1000000;
      const milWord = mil === 1 ? 'un mill√≥n' : convert(mil) + ' millones';
      return milWord + (rest ? ' ' + convert(rest) : '');
    }
    return n.toLocaleString('es-MX');
  }
  
  return convert(n);
}

// Init
updateUI();
</script>
</body>
</html>
